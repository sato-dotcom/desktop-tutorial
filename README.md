# 海洋版測量支援アプリ「うみねこ」開発サマリー

この開発は複数のAIを協力させて進めています。

🔄 役割分担

(1)私のコメント:開発者・ユーザー(Akinori):実験環境、テスト結果、ユーザーとしての期待挙動を記録。

(2)ChatGPT(無料枠GPT-5):技術顧問:設計レビュー・ロジック検証・問題点や見落としを技術的に分析。

(3)Copilot(PCデフォルト無料枠):開発ディレクター：進行管理・課題整理・記録(Githubを利用)、Geminiへの指示文作成

(4)Gemini(2.5Pro):実装エンジニア:実際にコードを修正し、Canvasで出力。

修正サイクル:(1)→(2)→(3)→(4)→(1)→

※ChatGPTは時間帯によってアクセスが不安定になるのでその時はサイクルを省略する


目標：ヘディングアップ表示の実装

📝 開発の経緯（要点）
課題
「Leafletでの全画面表示切替時に現在地マーカーがずれる／動かない」問題。
追従モード（ON/OFF）や地図の向き（ノースアップ／ヘディングアップ）を組み合わせると挙動が安定しない。

試したアプローチ
requestAnimationFrame や setTimeout で遅延 → 改善せず。
map.once('resize', ...) に委ねる → 変化なし。
強制リフロー (container.offsetWidth) → 効果なし。
updateMapView(true) を呼ぶ方式 → 意図通り動かず。
ピクセル補正（panBy）方式 → 稀に成功するが安定せず。
GPS更新とUIイベントをフラグで連携 → 結果は変わらず。
最後に「resize イベント完了後に updateMapView を呼ぶ」方式も試したが期待通りに動かない。
現状 どの方式でも「全画面切替直後の現在地再配置」が安定して動作していない。
室内・屋外でテストしたが同じ結果。 挙動としては「全画面ONにしてもOFF時の中央位置にマーカーが残る」。

## 🧭 やり取りフォーマット（AI連携用）

--- 私のコメント ---
実験の結果や気づいた点を書く

--- ChatGPTのレビュー ---
コードや挙動の技術的分析（設計・ロジック）

--- Copilotのレビュー ---
UI挙動や実務的な視点からの技術分析

--- Geminiへの要望文 ---
実際に修正してほしい内容を明確に指示


👉 この形式なら、次のAIが「誰の発言か」を混同せずに理解しやすく、同じ失敗を繰り返さない。
