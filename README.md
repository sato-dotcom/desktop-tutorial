# 海洋版測量支援アプリ「うみねこ」README

## 概要

現場での測量作業を効率化するためのブラウザベースの支援ツール。複数のAIとの協働により、技術検証・改善・記録を継続的に行っています。

Copilot Pagesを用いて修正履歴や技術検証ログを記録・整理しています。

## プロジェクト概要

- **目的**：海上・沿岸部での測量作業を支援する軽量・実用的なWebアプリの開発  
- **対象ユーザー**：現場の測量技術者、調査員、施工管理者  
- **特徴**：
  - ブラウザで動作（インストール不要）
  - 地図表示・現在地マーカー・全画面切替対応
  - Heading-up表示の実装を検討中

## 技術スタック

| 技術         | 用途               |
|--------------|--------------------|
| HTML / CSS / JavaScript | フロントエンド       |
| [Leaflet.js](https://Leaflet.js) | 地図表示と現在地マーカー |
| GitHub Pages | ホスティング       |
| AIツール（Copilot, Gemini） | 技術検証・コードレビュー・改善提案 |

## セットアップ手順

1. このリポジトリをクローン  
   ```bash
   git clone https://github.com/sato-dotcom/desktop-tutorial

2. index.html をブラウザで開く

3. モバイル端末でも動作確認可能（Chrome推奨）


## 技術検証ログ（別ファイル）

- `map.once('resize')` によるマーカー再描画のタイミング調整  
- `requestAnimationFrame` を用いた描画安定化の試行  
- `updateMapView(true)` によるマーカー位置補正の効果検証  

## TODO / 今後の課題

- Heading-up表示の安定化とUI調整  
- モバイル端末での動作検証（GPS精度・画面サイズ対応）  
- 地図切替時のマーカーズレ防止  
- フィールドテストによる実用性評価  

## 開発の経緯（別ファイル）

### 背景・経緯（2025年9月3日）

ブラウザベースの測量支援アプリ（Leaflet使用）にて、全画面表示切替後に現在地マーカーが中央に配置されない問題が発生。追従モードや地図の向き（ノースアップ／ヘディングアップ）との組み合わせで挙動が不安定になる。

屋内外でテスト済み。全画面ONにしても、OFF時の中央位置にマーカーが残る。

### 試したこと（技術的アプローチの記録）

- `requestAnimationFrame` / `setTimeout` → 効果なし  
- `map.once('resize', ...)` → 効果なし  
- `container.offsetWidth` で強制リフロー → 効果なし  
- `updateMapView(true)` → 意図通り動かず  
- `panBy` でピクセル補正 → 稀に成功するが安定せず  
- GPS更新とUIイベントをフラグで連携 → 結果変わらず  
- resize イベント完了後に `updateMapView` → 期待通りに動かない  

### 現状と期待する挙動（2025年9月3日）

- 全画面切替直後に現在地が中央に配置されない  
- 室内・屋外で同様の挙動  
- 期待する挙動：全画面切替後、追従モードONなら現在地がマップ中央に配置されること  

## AI連携履歴（別ファイル）

### 役割

| 役者       | 役職             | 内容                                     |
|------------|------------------|------------------------------------------|
| 私 / ユーザー / Akinori | 責任者           | AI間の橋渡し、動作確認、記録管理             |
| ChatGPT    | 技術顧問         | 設計レビュー、ロジック検証、補足説明         |
| Copilot    | 開発ディレクター | 進行管理、課題整理、履歴記録、技術方針の提案 |
| Gemini     | 実装エンジニア   | コード修正、テスト対応、構文エラーの解消     |

### AI連携履歴

| 日付       | AI      | 内容                                                   |
|------------|---------|--------------------------------------------------------|
| 2025/09/01 | Copilot | Leafletのresizeイベントに関する検討と提案             |
| 2025/09/02 | Gemini  | マーカー位置ズレの修正案をIssue #1に記録              |
| 2025/09/03 | Copilot | READMEテンプレートの設計と構成支援                    |
| 2025/09/05 | Gemini  | 全画面切替後のマーカー再配置に関するコード修正        |
| 2025/09/08-(1) | Gemini  | 全画面表示・コンパス挙動・イベント処理の安定化       |
| 2025/09/08-(2) | Gemini  | マーカー中央固定・イベントバインド・TailwindCSS対応  |
| 2025/09/08-(3) | Gemini  | Node.js導入・ビルド構成再整理・GitHub容量制限対応     |
